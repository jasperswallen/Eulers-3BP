\documentclass[preprint,titlepage,preprintnumbers,amsmath,amssymb,aps,11pt]{revtex4-2}

\usepackage[utf8]{inputenc}  % UTF-8 enabled
\usepackage{graphicx}  % Include figure files
\usepackage{xcolor}  % Allow for a color text
\usepackage{amsmath}  % math fonts
\usepackage{amsfonts}  % math fonts
\usepackage{latexsym}  % math fonts
\usepackage{amssymb}  % math fonts
\usepackage{bm}  % bold math fonts
\usepackage{hyperref}  % add hypertext capabilities
\usepackage{setspace}
\usepackage{listings}

\graphicspath{ {images/} }

\begin{document}

\preprint{\textcolor{red}{PHYS-304:} Fall 2020}
\title{Modeling Dynamics of Euler's Three Body Problem}
\author{Jasper Swallen}
\affiliation{
    Department of Physics and Astronomy, University of Southern California,
    Los Angeles, California 90089, USA
}
\date{\today}


\begin{abstract}
    Abstract goes here
        {\singlespacing \tableofcontents}
\end{abstract}

\maketitle


\section{Background and Applications}
Euler's Three Body Problem is a simplification of the 3-body problem (which is itself a special case of the N-body problem). In it, two large bodies are fixed at points in space (and are assumed to not act upon each other), while one smaller body is free to move through space. This smaller body's movement is dependent only on its relative position to the two larger masses and their masses. It can be assumed that the smaller mass $m$ is much smaller than the two larger masses $m_2$ and $m_3$. This can therefore be represented by a one-body problem. Given the level of simplification, it would not seem that this system is a close representation of real-world problems. However, this is not the case.

There are two main applications of this problem. In a model solar system with two large stars and an orbiting planet, the movement of the planet can be described by these dynamics if the stars are too far apart to significantly attract each other but the planet is moving quickly enough to oscillate between their fields (for example, Fig. \ref{fig:orbit}). The other application is in an electric field. Although electric fields are not described by exactly the same forces, their potential is still inverse to the distance. Thus, an analogue would be an electron moving through the electric field of two nuclei.

\begin{figure}
    \centering
    \includegraphics[width=0.5\textwidth]{Fig 1.jpeg}
    \caption{A model solar system with simplified orbits}
    \label{fig:orbit}
\end{figure}

Newton's Law of Gravitation states that, for any two masses $m_1$ and $m_2$ separated by a radius $r=|\bm{r_1}-\bm{r_2}|$ (where $\bm{r_1}$ and $\bm{r_2}$ are the positions of $m_1$ and $m_2$, respectively), the gravitational force of $m_2$ on $m_1$ is
\begin{equation}
    \bm{F_{12}}=-\frac{Gm_1 m_2}{|\bm{r_1}-\bm{r_2}|^3}*(\bm{r_1}-\bm{r_2})
\end{equation}
and the potential energy is
\begin{equation}
    U(\bm{r_1},\bm{r_2})=-\frac{Gm_1 m_2}{|\bm{r_1}-\bm{r_2}|}
\end{equation}
Since gravitation forces can be superimposed, the force of every body on a given body in an N-body system can be calculated as
\begin{equation}
    \bm{F_i}=\sum_{j=1, j \neq i}^N -\frac{Gm_im_j}{|\bm{r_i}-\bm{r_j}|}*(\bm{r_i}-\bm{r_j})
\end{equation}
Additionally, this is a closed system, so the total energy of the system is conserved.

\section{General Equations of Motion}
The given simplification of the problem into a one-body problem results (in the plane) in two degrees of freedom. In 3-dimensional space, there are three degrees of freedom. If the three masses initially lie in a plane together, they will remain in this plane. For simplicity, the initial conditions will be chosen for such a case.

Since the total energy of the system is preserved, and the potential of the system can be described as above, the following equations of energy hold
\begin{equation}
    \begin{aligned}
        T   & =\frac{1}{2}mv^2=\frac{1}{2}m(\dot{x}^2 + \dot{y}^2)                                                 \\
        U_i & =-\frac{Gmm_i}{|\bm{r_i}-\bm{r}|}                                                                    \\
        E   & =\frac{1}{2}m(\dot{x}^2 + \dot{y}^2)-\frac{Gmm_1}{|\bm{r_1}-\bm{r}|}-\frac{Gmm_2}{|\bm{r_2}-\bm{r}|}
    \end{aligned}
\end{equation}
While solving a Lagrangian or Hamiltonian with these equations in cartesian coordinates is possible, simplifications arise when the system is converted to an elliptical coordinate system $(\xi,\eta)$ (see Fig. \ref{fig:coordinatesys}). If the masses are positioned in this coordinate system at the foci $2f$ apart, which can be done by rotating and shifting, this is translatable to $x=f\cosh{\xi}\cos{\eta}$ and $y=f\sinh{\xi}\sin{\eta}$.
\begin{figure}
    \centering
    \includegraphics[width=0.5\textwidth]{Fig 2.png}
    \caption{the elliptical coordinate system $(\xi,\eta)$. $\xi$ can be thought of as correspondent to radial distance, and $\eta$ the angle. Adopted from \cite{Krishnaswami2019}}
    \label{fig:coordinatesys}
\end{figure}

Therefore, there are two conserved quantities in the system: Whittaker's constant (see \cite[p. 100]{Krishnaswami2019}) and total energy. Whittaker's constant can be represented as
\begin{equation}
    \begin{aligned}
        w & =\bm{L_1}\cdot\bm{L_2}+2mf(-\mu _1 \cos{\theta _1} +\mu _2 \cos{\theta _2})                           \\
          & =m^2r_1^2r_2^2\dot{\theta _1}^2\dot{\theta _2}^2+2mf(-\mu _1 \cos{\theta _1} +\mu _2 \cos{\theta _2}) \\
          & =-2mf^2E-\alpha
    \end{aligned}
\end{equation}
where $r_i$ is the distance $|\bm{r_i}-\bm{r}|$ between $m_i$ and $m$; $\bm{L_i}=mr_i^2\dot{\theta _i}\hat{z}$ is the angular momentum of a mass; $\theta _i$ is the angle between $\bm{r_i}$ and the $x$-axis; $\mu _i=Gmm_i$; and $\alpha$ is the “separation constant” derived from the separation of variables of $E$ in elliptical coordinates \cite[p. 101]{Krishnaswami2019}.

By using the Hamilton-Jacobi equation and Liouville's theorem, this system can be solved analytically. See Ó'Mathúna \cite[pages 49-105 and 113-142]{OMathuna2008} for a detailed solution.

\section{Numerical Solution}
\subsection{Finding Equations}
While analytical solutions are useful for determining the exact motion of systems, numerical solutions are often much simpler. Such is the case here.
To do this, without loss of generality, shift the system so that $m_1$ is at the origin and $m_2$ is a distance $d$ along the $y$-axis from the origin. Now represent $m_2$ as a factor of $m_1=m_a$ such that $m_2=\alpha m_a$, as shown in Fig. \ref{fig:shiftedsys}.
\begin{figure}
    \centering
    \includegraphics[width=0.5\textwidth]{Fig 3.jpeg}
    \caption{the shifted system with $m_1$ at the origin}
    \label{fig:shiftedsys}
\end{figure}

Up until this point, the masses and distances have been unitless and arbitrary. If these masses are instead measured in terms of solar units, further simplifications arise. If $m_a$ is set to a “solar mass”, we see that $Gm_a=4\pi^2$. This is because the angular velocity of a mass around a primary (for example, the Earth around the Sun) is $2\pi*AU/yr$, where $AU$ is the average distance between the primary and the mass.

Since the origin is now fixed, the equations of motion now use relative positioning to the origin (and $m_1$). From this and Newton's Law of Gravitation,
\begin{equation}
    F_x=-\frac{Gm_a m}{r_1^3}x-\frac{G\alpha m_a m}{r_2^3}(x-d)
    \label{eq:fx}
\end{equation}
\begin{equation}
    F_y=-\frac{Gm_a m}{r_1^3}y-\frac{G\alpha m_a m}{r_2^3}y
    \label{eq:fy}
\end{equation}
with $r_i=|\bm{r_i}-\bm{r}|$ the distance between $m$ and $m_i$. In cartesian coordinates, this results in
\begin{equation}
    \begin{aligned}
        \bm{r_1} & =x\hat{x}+y\hat{y}     \\
        \bm{r_2} & =(x-d)\hat{x}+y\hat{y}
    \end{aligned}
\end{equation}
so
\begin{equation}
    \begin{aligned}
        r_1 & =\sqrt{x^2+y^2}     \\
        r_2 & =\sqrt{(x-d)^2+y^2}
    \end{aligned}
\end{equation}

Since the equations of acceleration are often used, I will define them explicitly here, dependent on $x$ and $y$ inputs
\begin{equation}
    \begin{aligned}
        \ddot{x}(x,y) & = 4\pi^2(\frac{x}{(x^2+y^2)^{\frac{3}{2}}}+\frac{\alpha(x-d)}{((x-d)^2+y^2)^{\frac{3}{2}}}) \\
        \ddot{y}(x,y) & = 4\pi^2y(\frac{1}{(x^2+y^2)^{\frac{3}{2}}}+\frac{1}{((x-d)^2+y^2)^{\frac{3}{2}}})
    \end{aligned}
\end{equation}
This is a system of nonlinear differential equations. As demonstrated above, analytical solutions are possible, but messy.

\subsection{Plottable Solutions}
\subsubsection{Euler's Method}
Using Euler's approximation
\begin{equation}
    x(t+\delta t)=x(t)+\delta t\dot{x}(t)+O(\delta t^2)
    \label{eq:eulersmethod}
\end{equation}
and neglecting higher order terms $O(\delta t^2)$, the solution is quickly plottable in cartesian coordinates. This has error on the order of $\delta t$ (\cite[p. 298]{Wild1980}).
Adapting \ref{eq:eulersmethod} for $x$, $y$, $\dot{x}$, and $\dot{y}$, we get the following system of equations.
\begin{equation}
    \begin{aligned}
        x_{n+1}       & =x_n+\dot{x}_n\delta t                       \\
        y_{n+1}       & =y_n+\dot{y}_n\delta t                       \\
        \dot{x}_{n+1} & =\dot{x}_n-\delta t\ddot{x}(x_{n+1},y_{n+1}) \\
        \dot{y}_{n+1} & =\dot{y}_n-\delta t\ddot{y}(x_{n+1},y_{n+1})
    \end{aligned}
\end{equation}
When they are evaluated in order, this is a programmable and plottable solution.
\subsubsection{Runge-Kutta Method}
Another way to incrementally solve integrable solutions is the Runge-Kutta method (specifically, the Runge-Kutta 4\textsuperscript{th} Order Method). With the same logic of interation as the Euler Method above, Runge-Kutta allows for more precision by using intermediate steps to calculate the $n+1$ position. The general Runge-Kutta 4\textsuperscript{th} order method is
\begin{equation}
    \begin{aligned}
        x_{n+1} & =x_n+\frac{1}{6}\delta t(k_1+2k_2+2k_3+k_4) \\
        k_1     & =f(x_n)                                     \\
        k_2     & =f(x_n+\delta t\frac{k_1}{2})               \\
        k_3     & =f(x_n+\delta t\frac{k_2}{2})               \\
        k_4     & =f(x_n+\delta tk_3)
    \end{aligned}
\end{equation}
In the context of this 3-Body problem, the equations become (evaluated in this order)
\begin{equation}
    \begin{aligned}
        x_{n+1}       & = x_n + \delta t\dot{x}_n                                                          \\
        y_{n+1}       & = y_n + \delta t\dot{y}_n                                                          \\
        {k_1}_x       & = \ddot{x}(x_{n+1},y_{n+1})                                                        \\
        {k_1}_y       & = \ddot{y}(x_{n+1},y_{n+1})                                                        \\
        {k_2}_x       & = \ddot{x}(x_{n+1}+ \delta t \frac{{k_1}_x}{2}, y_{n+1}+\delta t\frac{{k_1}_y}{2}) \\
        ...                                                                                                \\
        \dot{x}_{n+1} & = \dot{x}_n + \frac{1}{6}\delta t({k_1}_x+2{k_2}_x+2{k_2}_x+{k_4}_x)
    \end{aligned}
\end{equation}

\subsubsection{Forest \& Neri Method}
\begin{equation}
    \begin{aligned}
         & \beta=2^\frac{1}{3}, c_4=c_1=\frac{1}{2(2-\beta)}, c_3=c_2=\frac{1-\beta}{2(2-\beta)} \\
         & d_3=d_1=\frac{1}{2-\beta}, d_2=\frac{-\beta}{2-\beta}, d_4\equiv 0
    \end{aligned}
\end{equation}
\begin{equation}
    \begin{split}
        &x_1=x_n+ \delta tc_1 \dot{x}_n\\
        &x_2=x_1+ \delta tc_2 \dot{x}_1\\
        &...\\
        &x_{n+1}=x_4
    \end{split}
    \qquad(\text{for }x\text{ and } y)\qquad
    \begin{split}
        &\dot{x}_1=\dot{x}_n+\delta td_1\ddot{x}(x_1,y_1)\\
        &\dot{x}_2=\dot{x}_1+\delta td_2\ddot{x}(x_2,y_2)\\
        &...\\
        &\dot{x}_{n+1}=\dot{x}_4
    \end{split}
\end{equation}


\section{Interpreting Solutions}
There are several cases in the limit where this solution demonstrates its clarity. The first case is when $d$ is very large (and $x$ is not). In this case, the terms dependent on $r_2$ disappear. This is equivalent to a system with only one star with mass $m_a$. On the other hand, if $d$ is very small, $r_1\approxeq r_2$. This is also equivalent to a system with one star, but this time the star has a mass $(1+\alpha)m_a$.

\bigskip

I have yet to finish my program, so I do not have plots of results to discuss. Once I do, I will analyze these plots, especially in terms of how varying different parameters results in different solutions, and how chaotic these parameters are.

Finally, I will demonstrate my code in the text and with a link to \href{https://github.com/jasperswallen/PHYS304-Project}{my public GitHub repository}
containing a Jupyter Notebook that readers will be able to download and run.

\appendix
\section{Code}
The code for this project is fully available at \href{https://github.com/jasperswallen/PHYS304-Project}{\color{blue}{\underline{my public GitHub repository}}},
containing both a Jupyter Notebook and command-line Python script. The following is \texttt{main.py::eulerMethod}, which calculates and plots the graph of Euler's Three Body Problem with Euler's numerical approximation method. This code is found in \texttt{main.py} and \texttt{main.ipynb}. The requirements to run this code are Python 3, \texttt{matplotlib}, and \texttt{numpy}. Then, run \texttt{\$ python3 main.py} and input the initial positions and masses of all three objects, as well as the initial velocity of the moving object.

\begin{lstlisting}[language=Python, numbers=left, breaklines=true]
def eulerMethod(mass_1_x, mass_1_y, mass_2_x, mass_2_y, alpha, moving_mass_x, moving_mass_y, moving_mass_x_prime, moving_mass_y_prime, its, delta):
    x = [moving_mass_x]
    y = [moving_mass_y]
    x_prime = [moving_mass_x_prime]
    y_prime = [moving_mass_y_prime]

    # We have the following equations of motion
    # x'_(n+1)=x'_n-deltat4pi^2 (x_(n+1)/(r_1^3)_(n+1) +alpha(x_(n+1)-d)/(r_2^3)_(n+1))
    # y'_(n+1)=y'_n-deltat4pi^2 y_(n+1) (1/(r_1^3)_(n+1) +alpha/(r_2^3)_(n+1))

    for n in range(its):
        # calculate next x, y, x', and y'
        x_n_plus_one = x[n] + delta * x_prime[n]
        x.append(x_n_plus_one)
        y_n_plus_one = y[n] + delta * y_prime[n]
        y.append(y_n_plus_one)

        x_prime_n_plus_one = x_prime[n] + delta * \
            calculateXAccel(x[n + 1], y[n + 1])
        x_prime.append(x_prime_n_plus_one)

        y_prime_n_plus_one = y_prime[n] + delta * \
            calculateYAccel(x[n + 1], y[n + 1])
        y_prime.append(y_prime_n_plus_one)

    plt.plot(x, y)

    masses = [[mass_1_x, mass_2_x, moving_mass_x],
              [mass_1_y, mass_2_y, moving_mass_y]]
    colors = np.array([[255, 0, 0], [0, 255, 0], [0, 0, 255]])

    plt.scatter(masses[0], masses[1], c=colors / 255)

    labels = ["m1", "m2", "m"]
    for i, txt in enumerate(labels):
        plt.annotate(txt, (masses[0][i], masses[1][i]))
\end{lstlisting}

The Runge-Kutta and Forest \& Neri methods work in a similar manner, although they require many more calculations per iteration.

\bibliography{bibliography}

\end{document}
